<%
  #solutions/vendor/items/_index
#locals=>solution,total
%>
<table class="table">
  <tbody>
    <tr>
      <th></th>
      <th>名称</th>
      <th>数量</th>
      <th>说明</th>
      <th>单价</th>
      <th>合计</th>
      <th></th>
    </tr>
    <%designs=solution.designs%>
    <%=render 'solutions/vendor/items/kind',
      :solution=>solution,
      :items=>designs,
      :kind_cn=>'设计' unless designs.empty?
    %>
    <%products=solution.products%>
    <%=render 'solutions/vendor/items/kind',
      :solution=>solution,
      :items=>products,
      :kind_cn=>'制作' unless products.empty?
    %>
    <%trans=solution.trans%>
    <%=render 'solutions/vendor/items/kind',
      :solution=>solution,
      :items=>trans,
      :kind_cn=>'运输' unless trans.empty?
    %>
    <%others=solution.others%>
    <%=render 'solutions/vendor/items/kind',
      :solution=>solution,
      :items=>others,
      :kind_cn=>'其他' unless others.empty?
    %>
  </tbody>
</table>
<% if total[:all] > 0%>
  <table class="table">
    <tbody>
      <tr>
        <th></th>
        <th>总计</th>
        <th>税率</th>
        <th>税后总计</th>
      </tr>
      <%n=0%>
      <%if total[:design] > 0%>
        <tr class="<%=['odd','even'][(n+=1)%2]%>">
          <td>设计</td>
          <td><%=total[:design]%></th>
          <td><%=solution.design_rate%></td>
          <td><%=total[:design_r]%></td>
        </tr>
      <%end%>
      <%if total[:product] > 0%>
        <tr class="<%=['odd','even'][(n+=1)%2]%>">
          <td>制作</td>
          <td><%=total[:product]%></th>
          <td><%=solution.product_rate%></td>
          <td><%=total[:product_r]%></td>
        </tr>
      <%end%>
      <%if total[:tran] > 0%>
        <tr class="<%=['odd','even'][(n+=1)%2]%>">
          <td>运输</td>
          <td><%=total[:tran]%></th>
          <td><%=solution.tran_rate%></td>
          <td><%=total[:tran_r]%></td>
        </tr>
      <%end%>
      <%if total[:other] > 0%>
        <tr class="<%=['odd','even'][(n+=1)%2]%>">
          <td>其他</td>
          <td><%=total[:other]%></th>
          <td><%=solution.other_rate%></td>
          <td><%=total[:other_r]%></td>
        </tr>
      <%end%>
      <tr class="<%=['odd','even'][(n+=1)%2]%>">
        <td>全部累计</td>
        <td><%=total[:all]%></th>
        <td></td>
        <td><%=total[:all_r]%></td>
      </tr>
    </tbody>
  </table>
<%end%>
<%= link_to '新建运输项', new_item_path(:solution_id=>solution.id,:kind=>'tran') %>
|
<%= link_to '新建其他项', new_item_path(:solution_id=>solution.id,:kind=>'other') %>
|
<%= link_to '修改税率', edit_rate_solution_path(solution) %>
<br/>

